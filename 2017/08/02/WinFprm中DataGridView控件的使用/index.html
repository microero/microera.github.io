<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>WinFprm中DataGridView控件的使用 | Microera的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="tags/随笔">
<meta name="keywords" content="C#,控件,WinForm">
<meta property="og:type" content="article">
<meta property="og:title" content="WinFprm中DataGridView控件的使用">
<meta property="og:url" content="http://yoursite.com/child/2017/08/02/WinFprm中DataGridView控件的使用/index.html">
<meta property="og:site_name" content="Microera的博客">
<meta property="og:description" content="tags/随笔">
<meta property="og:updated_time" content="2017-08-02T08:03:57.483Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WinFprm中DataGridView控件的使用">
<meta name="twitter:description" content="tags/随笔">
  
    <link rel="alternative" href="/atom.xml" title="Microera的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">Microera的博客</a></h1>
        </hgroup>

        
        <p class="header-subtitle">Yanjun Wang</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/Home">博客首页</a></li>
                        
                            <li><a href="/works">作品展示</a></li>
                        
                            <li><a href="/about">留言打卡</a></li>
                        
                            <li><a href="/tags">静心阅读</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=GHVxe2p3eX99WH53YHV5cXQ2e3d1" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://git.oschina.net/microera" title="github">github</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/u/5811462452" title="weibo">weibo</a>
                            
                                <a class="fl rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                                <a class="fl QQ" target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=24320187&site=qq&menu=yes" title="QQ">QQ</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/C/" style="font-size: 10px;">C#</a> <a href="/tags/WinForm/" style="font-size: 10px;">WinForm</a> <a href="/tags/控件/" style="font-size: 10px;">控件</a> <a href="/tags/简介/" style="font-size: 10px;">简介</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://microera.oschina.io/">github</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://jq.qq.com/?_wv=1027&k=4FIJvv0">QQ群</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">纯网迷、爱运动、爱交友、爱旅行、喜欢接触新鲜事物、迎接新的挑战，更爱游离于错综复杂的编码与逻辑中</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">Microera的博客</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">Microera的博客</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Yanjun Wang</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/Home">博客首页</a></li>
                
                    <li><a href="/works">作品展示</a></li>
                
                    <li><a href="/about">留言打卡</a></li>
                
                    <li><a href="/tags">静心阅读</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=GHVxe2p3eX99WH53YHV5cXQ2e3d1" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://git.oschina.net/microera" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/u/5811462452" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                        <a class="QQ" target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=24320187&site=qq&menu=yes" title="QQ">QQ</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-WinFprm中DataGridView控件的使用" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/08/02/WinFprm中DataGridView控件的使用/" class="article-date">
      <time datetime="2017-08-02T06:01:56.000Z" itemprop="datePublished">2017-08-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      WinFprm中DataGridView控件的使用
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/">C#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WinForm/">WinForm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/控件/">控件</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>##datagridview控件使用前言</p>
<p>由于最近使用winform来写程序，因为系统需要，使用到了datagridview控件，在网上查阅了大量的资料，最后可以整理为两种模式，一种较为简单，但是如果多次使用到这个控件会导致出现大量重复代码，不是最优化的效果，但是不利于后期修改，这不是我们想要的结果，第二种较为繁琐，封装成一个类，然后引用封装的这个类就可以了，这样提高了代码利用率！</p>
<blockquote>
<ul>
<li><p><strong>第一种：</strong> 获取数据库配置信息，new一个链接，做一个查询，返回生成一个table，然后再填充到控件。 </p>
</li>
<li><p><strong>第二种：</strong> 将第一种封装成一个类，然后里面的写成变量，传递参数，然后调用就可以，方便快捷省事。</p>
</li>
</ul>
</blockquote>
<h3 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h3><p>//连接数据库读取数据，为DataGridView赋值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> String strConn = &quot;server= .\XWPC_DATABASE;uid=数据库用户名;pwd=数据库密码;database=数据库名&quot;;</div><div class="line">SqlConnection conn = new SqlConnection(strConn);</div><div class="line">String sqlId = &quot;select * from [USER] &quot;;</div><div class="line">conn.Open();</div><div class="line">SqlCommand cmd = new SqlCommand(sqlId, conn);</div><div class="line">SqlDataAdapter da = new SqlDataAdapter(cmd);</div><div class="line"></div><div class="line">DataSet ds = new DataSet();</div><div class="line">da.Fill(ds, &quot;USER&quot;);</div><div class="line"></div><div class="line">DataGridView.DataSource = ds;</div><div class="line">DataGridView.DataMember = &quot;USER&quot;;</div><div class="line"></div><div class="line">conn.Close();</div></pre></td></tr></table></figure></p>
<h3 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h3><blockquote>
<p>将第一种的语句封装到一个类，调用</p>
</blockquote>
<h4 id="举例子"><a href="#举例子" class="headerlink" title="举例子"></a>举例子</h4><p>例如封装到sqlhelper类中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">public static DataSet ExecuteDataSet(string sql,SqlParameter[] parameters,String cls)</div><div class="line">        &#123;</div><div class="line">            using (SqlConnection conn = new SqlConnection(dbConnStr))</div><div class="line">            &#123;</div><div class="line">                conn.Open();</div><div class="line">                using (SqlCommand cmd = conn.CreateCommand())</div><div class="line">                &#123;</div><div class="line">                    cmd.CommandText = sql;</div><div class="line">                    if (null != parameters)</div><div class="line">                    &#123;</div><div class="line">                        cmd.Parameters.AddRange(parameters);</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    SqlDataAdapter adapter = new SqlDataAdapter(cmd);</div><div class="line">                    DataSet dataSet = new DataSet();</div><div class="line">                    adapter.Fill(dataSet, cls);</div><div class="line">                    //  return dataSet.Tables[0];</div><div class="line">                    return dataSet;</div><div class="line"> </div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">``` </div><div class="line">引用</div><div class="line">```c#</div><div class="line">PeopleModel peopleModel = new PeopleModel();</div><div class="line">peopleModel.people_name=tbxname.Text.Trim();</div><div class="line">peopleModel.people_ruxue = tbxruxue.Text.Trim();</div><div class="line">peopleModel.people_xibie = tbxxibie.Text.Trim();</div><div class="line">peopleModel.people_zhuanye = tbxzhuanye.Text.Trim();</div><div class="line">peopleModel.people_qq = tbxqq.Text.Trim();</div><div class="line"></div><div class="line">PeopleDAL peopleDAL = new PeopleDAL();</div><div class="line">this.studentlist.DataSource = peopleDAL.findObjCount(peopleModel, &quot;T_Class&quot;);</div><div class="line">his.studentlist.AutoGenerateColumns = false;//关闭自动增加的列</div><div class="line">this.studentlist.DataMember = &quot;T_Class&quot;;</div></pre></td></tr></table></figure></p>
<h4 id="常用属性"><a href="#常用属性" class="headerlink" title="常用属性"></a>常用属性</h4><p>取得当前单元格内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Console.WriteLine(DataGridView1.CurrentCell.Value);</div></pre></td></tr></table></figure></p>
<p>取得当前单元格的列 Index<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Console.WriteLine(DataGridView1.CurrentCell.ColumnIndex);</div></pre></td></tr></table></figure></p>
<p>取得当前单元格的行 Index<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Console.WriteLine(DataGridView1.CurrentCell.RowIndex);</div></pre></td></tr></table></figure></p>
<h2 id="其他属性"><a href="#其他属性" class="headerlink" title="其他属性"></a>其他属性</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div></pre></td><td class="code"><pre><div class="line">一、</div><div class="line">DataGridView 取得或者修改当前单元格的内容： </div><div class="line">当前单元格指的是 DataGridView 焦点所在的单元格，它可以通过 DataGridView 对象的 CurrentCell 属性取得。如果当前单元格不存在的时候，返回Nothing(C#是null) </div><div class="line">// 取得当前单元格内容 </div><div class="line">Console.WriteLine(DataGridView1.CurrentCell.Value); </div><div class="line">// 取得当前单元格的列 Index </div><div class="line">Console.WriteLine(DataGridView1.CurrentCell.ColumnIndex); </div><div class="line">// 取得当前单元格的行 Index </div><div class="line">Console.WriteLine(DataGridView1.CurrentCell.RowIndex); </div><div class="line">另外，使用 DataGridView.CurrentCellAddress 属性（而不是直接访问单元格）来确定单元格所在的行：DataGridView.CurrentCellAddress.Y 和列： DataGridView.CurrentCellAddress.X 。这对于避免取消共享行的共享非常有用。 </div><div class="line">当前的单元格可以通过设定 DataGridView 对象的 CurrentCell 来改变。可以通过 CurrentCell 来设定 </div><div class="line">DataGridView 的激活单元格。将 CurrentCell 设为 Nothing(null) 可以取消激活的单元格。 </div><div class="line">// 设定 (0, 0) 为当前单元格 </div><div class="line">DataGridView1.CurrentCell = DataGridView1[0, 0]; </div><div class="line">在整行选中模式开启时，你也可以通过 CurrentCell 来设定选定行。 </div><div class="line">/**////</div><div class="line"></div><div class="line">/// 向下遍历 </div><div class="line">///</div><div class="line"></div><div class="line">/// </div><div class="line">/// </div><div class="line">private void button4_Click(object sender, EventArgs e) </div><div class="line">...&#123; </div><div class="line">int row = this.dataGridView1.CurrentRow.Index + 1; </div><div class="line">if (row &gt; this.dataGridView1.RowCount - 1) </div><div class="line">row = 0; </div><div class="line">this.dataGridView1.CurrentCell = this.dataGridView1[0, row]; </div><div class="line">&#125; </div><div class="line"></div><div class="line">/**////</div><div class="line"></div><div class="line">/// 向上遍历 </div><div class="line">///</div><div class="line"></div><div class="line">/// </div><div class="line">/// </div><div class="line">private void button5_Click(object sender, EventArgs e) </div><div class="line">...&#123; </div><div class="line">int row = this.dataGridView1.CurrentRow.Index - 1; </div><div class="line">if (row &lt; 0) </div><div class="line">row = this.dataGridView1.RowCount - 1; </div><div class="line">this.dataGridView1.CurrentCell = this.dataGridView1[0, row]; </div><div class="line">&#125; </div><div class="line">* 注意: this.dataGridView 的索引器的参数是: columnIndex, rowIndex 或是 columnName, rowIndex </div><div class="line">这与习惯不同。 </div><div class="line">②　DataGridView 设定单元格只读： </div><div class="line">1） 使用 ReadOnly 属性 </div><div class="line">?　如果希望，DataGridView 内所有单元格都不可编辑， 那么只要： </div><div class="line">[C#] </div><div class="line">// 设置 DataGridView1 为只读 </div><div class="line">DataGridView1.ReadOnly = true; </div><div class="line">此时，用户的新增行操作和删除行操作也被屏蔽了。 </div><div class="line">?　如果希望，DataGridView 内某个单元格不可编辑， 那么只要： </div><div class="line">[C#] </div><div class="line">// 设置 DataGridView1 的第2列整列单元格为只读 </div><div class="line">DataGridView1.Columns[1].ReadOnly = true; </div><div class="line">// 设置 DataGridView1 的第3行整行单元格为只读 </div><div class="line">DataGridView1.Rows[2].ReadOnly = true; </div><div class="line">// 设置 DataGridView1 的[0，0]单元格为只读 </div><div class="line">DataGridView1[0, 0].ReadOnly = true; </div><div class="line">2） 使用 EditMode 属性 </div><div class="line">DataGridView.EditMode 属性被设置为 DataGridViewEditMode.EditProgrammatically 时，用户就不能手动编辑单元格的内容了。但是可以通过程序，调用 DataGridView.BeginEdit 方法，使单元格进入编辑模式进行编辑。 </div><div class="line">[C#] </div><div class="line">DataGridView1.EditMode = DataGridViewEditMode.EditProgrammatically; </div><div class="line">3） 根据条件设定单元格的不可编辑状态 </div><div class="line">当一个一个的通过单元格坐标设定单元格 ReadOnly 属性的方法太麻烦的时候，你可以通过 CellBeginEdit 事件来取消单元格的编辑。 </div><div class="line">[C#] </div><div class="line">// CellBeginEdit 事件处理方法 </div><div class="line">private void DataGridView1_CellBeginEdit(object sender, </div><div class="line">DataGridViewCellCancelEventArgs e) </div><div class="line">&#123; </div><div class="line">DataGridView dgv = (DataGridView)sender; </div><div class="line">//是否可以进行编辑的条件检查 </div><div class="line">if (dgv.Columns[e.ColumnIndex].Name == &quot;Column1&quot; &amp;&amp; </div><div class="line">!(bool)dgv[&quot;Column2&quot;, e.RowIndex].Value) </div><div class="line">&#123; </div><div class="line">// 取消编辑 </div><div class="line">e.Cancel = true; </div><div class="line">&#125; </div><div class="line">&#125;</div><div class="line">二、</div><div class="line">DataGridView 不显示最下面的新行：</div><div class="line">通常 DataGridView 的最下面一行是用户新追加的行（行头显示 * ）。如果不想让用户新追加行即不想显示该新行，可以将 DataGridView 对象的 AllowUserToAddRows 属性设置为 False。</div><div class="line">[C#]</div><div class="line">// 设置用户不能手动给 DataGridView1 添加新行</div><div class="line">DataGridView1.AllowUserToAddRows = false;</div><div class="line">但是，可以通过程序： DataGridViewRowCollection.Add 为 DataGridView 追加新行。</div><div class="line">补足： 如果 DataGridView 的 DataSource 绑定的是 DataView, 还可以通过设置 DataView.AllowAdd</div><div class="line">属性为 False 来达到同样的效果。</div><div class="line">④　DataGridView 判断新增行：</div><div class="line">DataGridView的AllowUserToAddRows属性为True时也就是允许用户追加新行的场合下，DataGridView的最后一行就是新追加的行(*行)。使用 DataGridViewRow.IsNewRow 属性可以判断哪一行是新追加的行。另外，通过DataGridView.NewRowIndex 可以获取新行的行序列号。在没有新行的时候，NewRowIndex = -1。 </div><div class="line">⑤　DataGridView 行的用户删除操作的自定义：</div><div class="line">1） 无条件的限制行删除操作。</div><div class="line">默认时，DataGridView 是允许用户进行行的删除操作的。如果设置 DataGridView对象的AllowUserToDeleteRows属性为 False 时， 用户的行删除操作就被禁止了。</div><div class="line">[C#]</div><div class="line">// 禁止DataGridView1的行删除操作。</div><div class="line">DataGridView1.AllowUserToDeleteRows = false;</div><div class="line">但是，通过 DataGridViewRowCollection.Remove 还是可以进行行的删除。</div><div class="line">补足： 如果 DataGridView 绑定的是 DataView 的话，通过 DataView.AllowDelete 也可以控制行的删除。</div><div class="line">2） 行删除时的条件判断处理。</div><div class="line">用户在删除行的时候，将会引发 DataGridView.UserDeletingRow 事件。 在这个事件里，可以判断条件并取消删除操作。</div><div class="line">[C#]</div><div class="line">// DataGridView1 的 UserDeletingRow 事件</div><div class="line">private void DataGridView1_UserDeletingRow(</div><div class="line">object sender, DataGridViewRowCancelEventArgs e)</div><div class="line">&#123;</div><div class="line">// 删除前的用户确认。</div><div class="line">if (MessageBox.Show(&quot;确认要删除该行数据吗？&quot;, &quot;删除确认&quot;,</div><div class="line">MessageBoxButtons.OKCancel,</div><div class="line">MessageBoxIcon.Question) != DialogResult.OK)</div><div class="line">&#123;</div><div class="line">// 如果不是 OK，则取消。</div><div class="line">e.Cancel = true;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">⑥　DataGridView 行、列的隐藏和删除：</div><div class="line">1） 行、列的隐藏</div><div class="line">[C#]</div><div class="line">// DataGridView1的第一列隐藏</div><div class="line">DataGridView1.Columns[0].Visible = false;</div><div class="line">// DataGridView1的第一行隐藏</div><div class="line">DataGridView1.Rows[0].Visible = false;</div><div class="line">2） 行头、列头的隐藏</div><div class="line">[C#]</div><div class="line">// 列头隐藏</div><div class="line">DataGridView1.ColumnHeadersVisible = false;</div><div class="line">// 行头隐藏</div><div class="line">DataGridView1.RowHeadersVisible = false;</div><div class="line">3） 行和列的删除 </div><div class="line">[C#] </div><div class="line">&apos; 删除名为&quot;Column1&quot;的列</div><div class="line">DataGridView1.Columns.Remove(&quot;Column1&quot;);</div><div class="line">&apos; 删除第一列 </div><div class="line">DataGridView1.Columns.RemoveAt(0);</div><div class="line">&apos; 删除第一行 </div><div class="line">DataGridView1.Rows.RemoveAt(0); </div><div class="line">4） 删除选中行</div><div class="line">[C#] </div><div class="line">foreach (DataGridViewRow r in DataGridView1.SelectedRows)</div><div class="line">&#123;</div><div class="line">if (!r.IsNewRow)</div><div class="line">&#123;</div><div class="line">DataGridView1.Rows.Remove(r);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">⑦ DataGridView 禁止列或者行的Resize：</div><div class="line">1） 禁止所有的列或者行的Resize</div><div class="line">[C#]</div><div class="line">// 禁止用户改变DataGridView1的所有列的列宽</div><div class="line">DataGridView1.AllowUserToResizeColumns = false;</div><div class="line">//禁止用户改变DataGridView1の所有行的行高</div><div class="line">DataGridView1.AllowUserToResizeRows = false;</div><div class="line">但是可以通过 DataGridViewColumn.Width 或者 DataGridViewRow.Height 属性设定列宽和行高。</div><div class="line">2） 禁止指定行或者列的Resize</div><div class="line">[C#]</div><div class="line">// 禁止用户改变DataGridView1的第一列的列宽</div><div class="line">DataGridView1.Columns[0].Resizable = DataGridViewTriState.False;</div><div class="line">// 禁止用户改变DataGridView1的第一列的行宽</div><div class="line">DataGridView1.Rows[0].Resizable = DataGridViewTriState.False;</div><div class="line">? 关于 NoSet</div><div class="line">当 Resizable 属性设为 DataGridViewTriState.NotSet 时， 实际上会默认以 DataGridView 的 AllowUserToResizeColumns 和 AllowUserToResizeRows 的属性值进行设定。比如： DataGridView.AllowUserToResizeColumns = False 且 Resizable 是 NoSet 设定时，Resizable = False 。</div><div class="line">判断 Resizable 是否是继承设定了 DataGridView 的 AllowUserToResizeColumns 和 AllowUserToResizeRows 的属性值， 可以根据 State 属性判断。如果 State 属性含有 ResizableSet，那么说明没有继承设定。</div><div class="line">3） 列宽和行高的最小值的设定</div><div class="line">[C#]</div><div class="line">// 第一列的最小列宽设定为 100 </div><div class="line">DataGridView1.Columns[0].MinimumWidth = 100;</div><div class="line">// 第一行的最小行高设定为 50</div><div class="line">DataGridView1.Rows[0].MinimumHeight = 50;</div><div class="line">4) 禁止用户改变行头的宽度以及列头的高度</div><div class="line">[C#]</div><div class="line">// 禁止用户改变列头的高度</div><div class="line">DataGridView1.ColumnHeadersHeightSizeMode =</div><div class="line">DataGridViewColumnHeadersHeightSizeMode.DisableResizing;</div><div class="line">// 禁止用户改变行头的宽度</div><div class="line">DataGridView1.RowHeadersWidthSizeMode =</div><div class="line">DataGridViewRowHeadersWidthSizeMode.EnableResizing;</div><div class="line"></div><div class="line">三、</div><div class="line">⑨ DataGridView 冻结列或行 </div><div class="line">1） 列冻结</div><div class="line">DataGridViewColumn.Frozen 属性为 True 时， 该列左侧的所有列被固定，横向滚动时固定列不随滚动条滚动而左右移动。这对于重要列固定显示很有用。 </div><div class="line">[C#]</div><div class="line">// DataGridView1的左侧2列固定</div><div class="line">DataGridView1.Columns[1].Frozen = true;</div><div class="line">但是，DataGridView.AllowUserToOrderColumns = True 时，固定列不能移动到非固定列，反之亦然。</div><div class="line">2） 行冻结</div><div class="line">DataGridViewRow.Frozen 属性为 True 时， 该行上面的所有行被固定， 纵向滚动时固定行不随滚动条滚动而上下移动。</div><div class="line">[C#]</div><div class="line">// DataGridView1 的上3行固定</div><div class="line">DataGridView1.Rows[2].Frozen = true;</div><div class="line">⑩ DataGridView 列顺序的调整</div><div class="line">设定 DataGridView 的 AllowUserToOrderColumns 为 True 的时候， 用户可以自由调整列的顺序。</div><div class="line">当用户改变列的顺序的时候，其本身的 Index 不会改变，但是 DisplayIndex 改变了。你也可以通过程序改变 DisplayIndex 来改变列的顺序。列顺序发生改变时会引发 ColumnDisplayIndexChanged 事件：</div><div class="line">[C#]</div><div class="line">// DataGridView1的ColumnDisplayIndexChanged事件处理方法</div><div class="line">private void DataGridView1_ColumnDisplayIndexChanged(object sender,</div><div class="line">DataGridViewColumnEventArgs e)</div><div class="line">&#123;</div><div class="line">Console.WriteLine(&quot;&#123;0&#125; 的位置改变到 &#123;1&#125; &quot;,</div><div class="line">e.Column.Name, e.Column.DisplayIndex);</div><div class="line">&#125;</div><div class="line">? DataGridView 行头列头的单元格</div><div class="line">[C#]</div><div class="line">// 改变DataGridView1的第一列列头内容</div><div class="line">DataGridView1.Columns[0].HeaderCell.Value = &quot;第一列&quot;;</div><div class="line">// 改变DataGridView1的第一行行头内容</div><div class="line">DataGridView1.Rows[0].HeaderCell.Value = &quot;第一行&quot;;</div><div class="line">// 改变DataGridView1的左上头部单元内容</div><div class="line">DataGridView1.TopLeftHeaderCell.Value = &quot;左上&quot;;</div><div class="line">另外你也可以通过 HeaderText 来改变他们的内容。</div><div class="line">[C#]</div><div class="line">// 改变DataGridView1的第一列列头内容</div><div class="line">DataGridView1.Columns[0].HeaderText = &quot;第一列&quot;;</div><div class="line">? DataGridView 剪切板的操作</div><div class="line">DataGridView.ClipboardCopyMode 属性被设定为 DataGridViewClipboardCopyMode.Disable 以外的情况时，「Ctrl + C」按下的时候，被选择的单元格的内容会拷贝到系统剪切板内。格式有： Text， UnicodeText，Html， CommaSeparatedValue。可以直接粘贴到 Excel 内。</div><div class="line">ClipboardCopyMode 还可以设定 Header部分是否拷贝： EnableAlwaysIncludeHeaderText 拷贝Header部分、EnableWithoutHeaderText 则不拷贝。默认是 EnableWithAutoHeaderText ， Header 如果选择了的话，就拷贝。</div><div class="line">1） 编程方式实现剪切板的拷贝</div><div class="line">Clipboard.SetDataObject(DataGridView1.GetClipboardContent()) </div><div class="line">2) DataGridView 的数据粘贴</div><div class="line">实现剪切板的拷贝比较容易，但是实现 DataGridView 的直接粘贴就比较难了。「Ctrl + V」按下进行粘贴时，DataGridView 没有提供方法，只能自己实现。</div><div class="line">以下，是粘贴时简单的事例代码，将拷贝数据粘贴到以选择单元格开始的区域内。</div><div class="line">[C#]</div><div class="line">//当前单元格是否选择的判断</div><div class="line">if (DataGridView1.CurrentCell == null)</div><div class="line">return;</div><div class="line">int insertRowIndex = DataGridView1.CurrentCell.RowIndex;</div><div class="line">// 获取剪切板的内容，并按行分割</div><div class="line">string pasteText = Clipboard.GetText();</div><div class="line">if (string.IsNullOrEmpty(pasteText))</div><div class="line">return;</div><div class="line">pasteText = pasteText.Replace(&quot; &quot;, &quot; &quot;);</div><div class="line">pasteText = pasteText.Replace(&apos; &apos;, &apos; &apos;);</div><div class="line">pasteText.TrimEnd(new char[] &#123; &apos; &apos; &#125;);</div><div class="line">string[] lines = pasteText.Split(&apos; &apos;);</div><div class="line">bool isHeader = true;</div><div class="line">foreach (string line in lines)</div><div class="line">&#123;</div><div class="line">// 是否是列头</div><div class="line">if (isHeader)</div><div class="line">&#123;</div><div class="line">isHeader = false;</div><div class="line">continue;</div><div class="line">&#125;</div><div class="line">// 按 Tab 分割数据</div><div class="line">string[] vals = line.Split(&apos; &apos;);</div><div class="line">// 判断列数是否统一</div><div class="line">if (vals.Length - 1 != DataGridView1.ColumnCount)</div><div class="line">throw new ApplicationException(&quot;粘贴的列数不正确。&quot;);</div><div class="line">DataGridViewRow row = DataGridView1.Rows[insertRowIndex];</div><div class="line">// 行头设定</div><div class="line">row.HeaderCell.Value = vals[0];</div><div class="line">// 单元格内容设定</div><div class="line">for (int i = 0; i &lt; row.Cells.Count; i++)</div><div class="line">&#123;</div><div class="line">row.Cells.Value = vals[i + 1];</div><div class="line">&#125;</div><div class="line">// DataGridView的行索引+1</div><div class="line">insertRowIndex++;</div><div class="line">&#125;</div><div class="line">? DataGridView 单元格的ToolTip的设置</div><div class="line">DataGridView.ShowCellToolTips = True 的情况下， 单元格的 ToolTip 可以表示出来。对于单元格窄小，无法完全显示的单元格， ToolTip 可以显示必要的信息。</div><div class="line">1） 设定单元格的ToolTip内容</div><div class="line">[C#]</div><div class="line">// 设定单元格的ToolTip内容</div><div class="line">DataGridView1[0, 0].ToolTipText = &quot;该单元格的内容不能修改&quot;;</div><div class="line">// 设定列头的单元格的ToolTip内容</div><div class="line">DataGridView1.Columns[0].ToolTipText = &quot;该列只能输入数字&quot;;</div><div class="line">// 设定行头的单元格的ToolTip内容</div><div class="line">DataGridView1.Rows[0].HeaderCell.ToolTipText = &quot;该行单元格内容不能修改&quot;;</div><div class="line">2） CellToolTipTextNeeded 事件</div><div class="line">在批量的单元格的 ToolTip 设定的时候，一个一个指定那么设定的效率比较低， 这时候可以利用 CellToolTipTextNeeded 事件。当单元格的 ToolTipText 变化的时候也会引发该事件。但是，当DataGridView的DataSource被指定且VirualMode=True的时候，该事件不会被引发。</div><div class="line">[C#]</div><div class="line">// CellToolTipTextNeeded事件处理方法</div><div class="line">private void DataGridView1_CellToolTipTextNeeded(object sender,</div><div class="line">DataGridViewCellToolTipTextNeededEventArgs e)</div><div class="line">&#123;</div><div class="line">e.ToolTipText = e.ColumnIndex.ToString() + &quot;, &quot; + e.RowIndex.ToString();</div><div class="line">&#125;</div><div class="line">? DataGridView 的右键菜单（ContextMenuStrip） </div><div class="line">DataGridView, DataGridViewColumn, DataGridViewRow, DataGridViewCell 有 ContextMenuStrip 属性。可以通过设定 ContextMenuStrip 对象来控制 DataGridView 的右键菜单的显示。 DataGridViewColumn 的 ContextMenuStrip 属性设定了 除了列头以外的单元格的右键菜单。 DataGridViewRow 的 ContextMenuStrip 属性设定了除了行头以外的单元格的右键菜单。DataGridViewCell 的 ContextMenuStrip 属性设定了指定单元格的右键菜单。 </div><div class="line">[C#]</div><div class="line">// DataGridView 的 ContextMenuStrip 设定</div><div class="line">DataGridView1.ContextMenuStrip = this.ContextMenuStrip1;</div><div class="line">// 列的 ContextMenuStrip 设定</div><div class="line">DataGridView1.Columns[0].ContextMenuStrip = this.ContextMenuStrip2;</div><div class="line">// 列头的 ContextMenuStrip 设定</div><div class="line">DataGridView1.Columns[0].HeaderCell.ContextMenuStrip = this.ContextMenuStrip2;</div><div class="line">// 行的 ContextMenuStrip 设定</div><div class="line">DataGridView1.Rows[0].ContextMenuStrip = this.ContextMenuStrip3;</div><div class="line">// 单元格的 ContextMenuStrip 设定</div><div class="line">DataGridView1[0, 0].ContextMenuStrip = this.ContextMenuStrip4;</div><div class="line">对于单元格上的右键菜单的设定，优先顺序是：　Cell &gt; Row &gt; Column &gt; DataGridView</div><div class="line">? CellContextMenuStripNeeded、RowContextMenuStripNeeded　事件</div><div class="line">利用　CellContextMenuStripNeeded　事件可以设定单元格的右键菜单，尤其但需要右键菜单根据单元格值的变化而变化的时候。比起使用循环遍历，使用该事件来设定右键菜单的效率更高。但是，在DataGridView使用了DataSource绑定而且是VirtualMode的时候，该事件将不被引发。</div><div class="line">[C#]</div><div class="line">//　CellContextMenuStripNeeded事件处理方法</div><div class="line">private void DataGridView1_CellContextMenuStripNeeded(object sender,</div><div class="line">DataGridViewCellContextMenuStripNeededEventArgs e)</div><div class="line">&#123;</div><div class="line">DataGridView dgv = (DataGridView)sender;</div><div class="line">if (e.RowIndex &lt; 0)</div><div class="line">&#123;</div><div class="line">//　列头的ContextMenuStrip设定</div><div class="line">e.ContextMenuStrip = this.ContextMenuStrip1;</div><div class="line">&#125;</div><div class="line">else if (e.ColumnIndex &lt; 0)</div><div class="line">&#123;</div><div class="line">//　行头的ContextMenuStrip设定</div><div class="line">e.ContextMenuStrip = this.ContextMenuStrip2;</div><div class="line">&#125;</div><div class="line">else if (dgv[e.ColumnIndex, e.RowIndex].Value is int)</div><div class="line">&#123;</div><div class="line">//　如果单元格值是整数时</div><div class="line">e.ContextMenuStrip = this.ContextMenuStrip3;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">同样，可以通过　RowContextMenuStripNeeded　事件来设定行的右键菜单。 [C#]</div><div class="line">//　RowContextMenuStripNeeded事件处理方法</div><div class="line">private void DataGridView1_RowContextMenuStripNeeded(object sender,</div><div class="line">DataGridViewRowContextMenuStripNeededEventArgs e)</div><div class="line">&#123;</div><div class="line">DataGridView dgv = (DataGridView)sender;</div><div class="line">//　当&quot;Column1&quot;列是Bool型且为True时、设定其的ContextMenuStrip</div><div class="line">object boolVal = dgv[&quot;Column1&quot;, e.RowIndex].Value;</div><div class="line">Console.WriteLine(boolVal);</div><div class="line">if (boolVal is bool &amp;&amp; (bool)boolVal)</div><div class="line">&#123;</div><div class="line">e.ContextMenuStrip = this.ContextMenuStrip1;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">CellContextMenuStripNeeded　事件处理方法的参数中、「e.ColumnIndex=-1」表示行头、「e.RowIndex=-1」表示列头。RowContextMenuStripNeeded则不存在「e.RowIndex=-1」的情况。</div><div class="line">? DataGridView 的单元格的边框、 网格线样式的设定 </div><div class="line">1) DataGridView 的边框线样式的设定</div><div class="line">DataGridView 的边框线的样式是通过 DataGridView.BorderStyle 属性来设定的。 BorderStyle 属性设定值是一个</div><div class="line">BorderStyle 枚举： FixedSingle（单线，默认）、Fixed3D、None。</div><div class="line">2) 单元格的边框线样式的设定</div><div class="line">单元格的边框线的样式是通过 DataGridView.CellBorderStyle 属性来设定的。 CellBorderStyle 属性设定值是</div><div class="line">DataGridViewCellBorderStyle 枚举。（详细参见 MSDN）</div><div class="line">另外，通过 DataGridView.ColumnHeadersBorderStyle 和 RowHeadersBorderStyle 属性可以修改 DataGridView 的头部的单元格边框线样式。属性设定值是 DataGridViewHeaderBorderStyle 枚举。（详细参见 MSDN）</div><div class="line">3） 单元格的边框颜色的设定</div><div class="line">单元格的边框线的颜色可以通过 DataGridView.GridColor 属性来设定的。默认是 ControlDarkDark 。但是只有在 CellBorderStyle 被设定为 Single、SingleHorizontal、SingleVertical 的条件下才能改变其边框线的颜色。同样，ColumnHeadersBorderStyle 以及 RowHeadersBorderStyle 只有在被设定为 Single 时，才能改变颜色。</div><div class="line">4） 单元格的上下左右的边框线式样的单独设定</div><div class="line">CellBorderStyle只能设定单元格全部边框线的式样。要单独改变单元格某一边边框式样的话，需要用到DataGridView.AdvancedCellBorderStyle属性。如示例：</div><div class="line">同样，设定行头单元格的属性是： AdvancedRowHeadersBorderStyle， 设定列头单元格属性是：AdvancedColumnHeadersBorderStyle。</div><div class="line">? DataGridView 单元格表示值的自定义</div><div class="line">通过CellFormatting事件，可以自定义单元格的表示值。（比如：值为Error的时候，单元格被设定为红色）</div><div class="line">下面的示例：将“Colmn1”列的值改为大写。</div><div class="line">[C#]</div><div class="line">//CellFormatting 事件处理方法</div><div class="line">private void DataGridView1_CellFormatting(object sender,</div><div class="line">DataGridViewCellFormattingEventArgs e)</div><div class="line">&#123;</div><div class="line">DataGridView dgv = (DataGridView)sender;</div><div class="line">// 如果单元格是“Column1”列的单元格</div><div class="line">if (dgv.Columns[e.ColumnIndex].Name == &quot;Column1&quot; &amp;&amp; e.Value is string)</div><div class="line">&#123;</div><div class="line">// 将单元格值改为大写</div><div class="line">string str = e.Value.ToString();</div><div class="line">e.Value = str.ToUpper();</div><div class="line">// 应用该Format，Format完毕。</div><div class="line">e.FormattingApplied = true;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">CellFormatting事件的DataGridViewCellFormattingEventArgs对象的Value属性一开始保存着未被格式化的值。当Value属性被设定表示用的文本之后，把FormattingApplied属性做为True，告知DataGridView文本已经格式化完毕。如果不这样做的话，DataGridView会根据已经设定的Format，NullValue，DataSourceNullValue，FormatProvider属性会将Value属性会被重新格式化一遍。</div><div class="line">? DataGridView 用户输入时，单元格输入值的设定</div><div class="line">通过 DataGridView.CellParsing 事件可以设定用户输入的值。下面的示例：当输入英文文本内容的时候，立即被改变为大写。</div><div class="line">[C#]</div><div class="line">//CellParsing 事件处理方法</div><div class="line">private void DataGridView1_CellParsing(object sender,</div><div class="line">DataGridViewCellParsingEventArgs e)</div><div class="line">&#123;</div><div class="line">DataGridView dgv = (DataGridView)sender;</div><div class="line">//单元格列为“Column1%2</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>更多资料请加群获取</p>
</blockquote>

      
      
        <div class="page-reward">
          <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang">赏</a></p>
          <div class="hide_box"></div>
          <div class="shang_box">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">×</a>
            <div class="shang_tit">
              <p>纯属好玩</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
            </div>
              <div class="pay_explain">扫码打赏，你说多少就多少</div>
            <div class="shang_payselect">
              
                <div class="pay_item checked" data-id="alipay">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/alipay.png" alt="支付宝" /></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/weixin.png" alt="微信" /></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>打开<span id="shang_pay_txt">支付宝</span>扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"支付宝":"微信");
          });
          function dashangToggle(){
            
            $(".hide_box").fadeToggle();
            $(".shang_box").fadeToggle();
          }
        </script>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/08/02/WinFprm中DataGridView控件的使用/">WinFprm中DataGridView控件的使用</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Microera的博客 的个人博客">Microera的博客</a></p>
        <p><span>发布时间:</span>2017年08月02日 - 14时01分</p>
        <p><span>最后更新:</span>2017年08月02日 - 16时03分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/08/02/WinFprm中DataGridView控件的使用/" title="WinFprm中DataGridView控件的使用">http://yoursite.com/child/2017/08/02/WinFprm中DataGridView控件的使用/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/child/2017/08/02/WinFprm中DataGridView控件的使用/　　作者: Microera的博客" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"Microera-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
  
    <a href="/2017/08/02/欢迎来到我的博客/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">欢迎来到我的个人博客</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#第一种"><span class="toc-number">1.</span> <span class="toc-text">第一种</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二种"><span class="toc-number">2.</span> <span class="toc-text">第二种</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#举例子"><span class="toc-number">2.1.</span> <span class="toc-text">举例子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常用属性"><span class="toc-number">2.2.</span> <span class="toc-text">常用属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他属性"><span class="toc-number"></span> <span class="toc-text">其他属性</span></a>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <section class="youyan" id="comments">

<!--PC和WAP自适应版-->
<div id="SOHUCS" sid="<?php the_ID(); ?>"></div>
<script type="text/javascript"> 
(function(){ 
var appid = 'cytaMJFLW'; 
var conf = '4dfb2846b35ab18482e01a5eed1c7aec'; 
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) { 
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
<script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/??lib/jquery.js,changyan.labs.js?appid=cysIa2Flb"></script>
            

</section>


    



    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2017/08/02/欢迎来到我的博客/" title="下一篇: 欢迎来到我的个人博客">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/08/02/WinFprm中DataGridView控件的使用/">WinFprm中DataGridView控件的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/02/欢迎来到我的博客/">欢迎来到我的个人博客</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 Microera的博客
            </div>
            <div class="footer-right">
                <a href="http://user.qzone.qq.com/24320187" target="_blank">官方空间</a>  来浪一波 <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=GHVxe2p3eX99WH53YHV5cXQ2e3d1" target="_blank">官方博客</a> by Microera
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >流氓到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>